
# https://protosupplies.com/product/capacitive-soil-moisture-sensor-module/
# - use nail varnish or similar to seal the edges of the pcb
# - VCC = 3.3V – 5.5V





esphome:
  name: kyticky

esp32:
  board: denky32

logger:

api:
  reboot_timeout: 0s
  password: ""

ota:
  password: ""

wifi:
  ssid: !secret ssid
  password: !secret password

  # Optional manual IP
  manual_ip:
    static_ip: 192.168.8.31
    gateway: 192.168.8.1
    subnet: 255.255.255.0
    dns1: 192.168.8.1
    
  ap:
    ssid: !secret fallback_ssid
    password: !secret fallback_password

    
    
captive_portal:


sensor:
  - platform: adc
    pin: 35
    id: dryness
    name: "dryness"
    update_interval: 1s
    attenuation: 11db
    filters:
      - multiply: 10
  - platform: sun
    name: Sun Elevation
    type: elevation
  - platform: sun
    name: Sun Azimuth
    type: azimuth


      
light:
  - platform: status_led
    name: "status"
    pin: 2

switch:
  - platform: gpio
    pin: 2
    id: s2
    name: "s2"
  - platform: gpio
    pin: 3
    id: s3
    name: "s3"


    
    
    
    
climate:
  - platform: thermostat
    name: "kyticky"
    sensor: dryness
    min_cooling_off_time: 1s
    min_cooling_run_time: 1s
    max_cooling_run_time: 2s
    min_idle_time: 1s
    supplemental_cooling_action:
      - lambda: |- 
          auto time = id(sntp_time).now();
      - if:
            condition:
                - sun.is_above_horizon:
            then:
                - logger.log: Sun is above horizon!
                - switch.turn_on: s2
                - switch.turn_on: s3
                - delay: 1s
                - switch.turn_off: s2
                - switch.turn_off: s3

            else:
                - logger.log: Sun is below horizon!
                
    supplemental_cooling_delta: 1
    cool_action:
      - logger.log: cool!
    idle_action:
      - switch.turn_off: s2
      - switch.turn_off: s3
    default_preset: Home
    preset:
      - name: Home
        mode: COOL
        default_target_temperature_high: 25 °C
    
    

    
#time:
#  - platform: sntp
#    on_time:
#      - seconds: /5
#        then:
#          - switch.turn_off: s2
    
web_server:
  port: 80
  ota: false




sun:

  latitude: 50.0755°
  longitude: 14.4378°

  on_sunrise:
    - then:
        - logger.log: Good morning!
  on_sunset:
    - then:
        - logger.log: Good evening!
        
text_sensor:
  - platform: sun
    name: Next Sunrise
    type: sunrise
  - platform: sun
    name: Next Sunset
    type: sunset
    
        
time:
  - platform: sntp
    id: sntp_time
    timezone: Europe/Prague
    on_time_sync:
      then:
        - logger.log: "Synchronized clock"
